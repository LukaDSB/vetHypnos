<div *ngIf="prontuario" class="container-prontuario poppins-bold">
  <div class="header">
    <div class="logo-instituto">
      <img src="../../../../assets/images/LogoIfes2.svg" alt="Logo IFES" />
    </div>
    <div class="infos-contato">
      <div class="info-item">
        <div class="icons-img">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
            class="size-6"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 0 0 2.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.38a12.035 12.035 0 0 1-7.143-7.143c-.162-.441.004-.928.38-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 0 0-1.091-.852H4.5A2.25 2.25 0 0 0 2.25 4.5v2.25Z"
            />
          </svg>
        </div>
        <div class="hypnosText--fonte2">
          <p>3564–1800</p>
        </div>
      </div>
      <div class="info-item">
        <div class="icons-img">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
            class="size-6"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75"
            />
          </svg>
        </div>
        <div class="hypnosText--fonte2">
          <p>gabinete.ale&#64;ifes.edu.br</p>
        </div>
      </div>
      <div class="info-item">
        <div class="icons-img">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
            class="size-6"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"
            />
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1 1 15 0Z"
            />
          </svg>
        </div>
        <div class="hypnosText--fonte2">
          <p>
            Rodovia ES-482<br />(Cachoeiro–Alegre, Km 72 –<br />
            Rive, Alegre – ES, 29500–000)
          </p>
        </div>
      </div>
    </div>
  </div>

  <div class="hypnosText--TituloGrande titulo">PRONTUÁRIO MÉDICO</div>
  <div class="hypnosText--fonte1 num-prontuario">
    Número: {{ prontuario.id }}
  </div>

  <div class="section-titulo">Informações do paciente</div>
  <div class="section-content">
    <div>
      <div class="label">Id</div>
      <div class="value">{{ prontuario.animal.id }}</div>
    </div>
    <div>
      <div class="label">Nome</div>
      <div class="value">{{ prontuario.animal.nome }}</div>
    </div>
    <div>
      <div class="label">Espécie</div>
      <div class="value">{{ prontuario.animal.especie || "?" }}</div>
    </div>
    <div>
      <div class="label">Idade</div>
      <div class="value">{{ animalIdade }} anos</div>
    </div>
    <div>
      <div class="label">Peso</div>
      <div class="value">{{ prontuario.animal.peso }} kg</div>
    </div>
    <div>
      <div class="label">Sexo</div>
      <div class="value">{{ prontuario.animal.sexo || "?" }}</div>
    </div>
  </div>

  <div class="section-titulo">Detalhes do procedimento</div>
  <div class="section-content-2">
    <div>
      <div class="label-2">Médico</div>
      <div class="value-2">{{ prontuario.procedimento.medico_nome }}</div>
    </div>
    <div>
      <div class="label-2">Tipo de Procedimento</div>
      <div class="value-2">{{ prontuario.procedimento.tipo }}</div>
    </div>
    <div>
      <div class="label-2">Data do Procedimento</div>
      <div class="value-2">
        {{ prontuario.data_prontuario | date : "dd/MM/yyyy" }}
      </div>
    </div>
    <div>
      <div class="label-2">Duração</div>
      <div class="value-2">{{ prontuario.procedimento.duracao || "?" }}</div>
    </div>
  </div>

  <div class="section-titulo">Parâmetros Clínicos</div>
  <div class="tabela-clinica-wrapper">
    <table
      mat-table
      [dataSource]="dataSource"
      class="mat-elevation-z8"
      *ngIf="dataSource.length > 0"
    >
      <ng-container matColumnDef="parametro"
        ><th mat-header-cell *matHeaderCellDef>Parâmetro</th>
        <td mat-cell *matCellDef="let element">
          {{ element.parametro }}
        </td></ng-container
      >
      <ng-container
        *ngFor="let horario of horariosDasColunas"
        [matColumnDef]="horario"
      >
        <th mat-header-cell *matHeaderCellDef class="table-time-header">
          {{ horario | date : "HH:mm" }}
        </th>
        <td mat-cell *matCellDef="let element">
          {{ (element[horario] | number : "1.0-3") || "-" }}
        </td>
      </ng-container>
      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
    </table>
    <div *ngIf="dataSource.length === 0" class="sem-medicoes-aviso">
      Nenhum parâmetro clínico foi registrado.
    </div>
  </div>

  <div class="medicamentos-section">
    <div class="section-titulo">Medicamentos</div>
    <div
      *ngIf="
        prontuario.medicamentos && prontuario.medicamentos.length > 0;
        else semMedicamentos
      "
    >
      <div *ngFor="let grupo of medicamentosAgrupados | keyvalue">
        <div class="section-subTitulo hypnosText--fonte1">{{ grupo.key }}</div>

        <div class="section-content-2 text-align-center">
          <div class="justify-content-between d-flex text-center">
            <div class="hypnosText--fonte1 label-2">Nome</div>
            <div class="hypnosText--fonte1 label-2">Volume mínimo</div>
            <div class="hypnosText--fonte1 label-2">Volume máximo</div>
          </div>
        </div>

        <div *ngFor="let med of grupo.value" class="section-content-3">
          <div class="justify-content-between d-flex">
            <div class="hypnosText--fonte1 label-2">{{ med.nome }}</div>
            <div class="hypnosText--fonte1 label-2">
              {{ (med.volume_min | number : "1.2-4") + "ml" }}
            </div>
            <div class="hypnosText--fonte1 label-2">
              {{ (med.volume_max | number : "1.2-4") + "ml" }}
            </div>
          </div>
        </div>
      </div>
    </div>
    <ng-template #semMedicamentos
      ><p class="sem-medicamentos-aviso">
        Nenhum medicamento administrado.
      </p></ng-template
    >
  </div>

  <hdk-divisor></hdk-divisor>

  <div>
    <h2 class="hypnosText--fonte1 obs">Observações</h2>
  </div>
  <div class="obs-area form-group">
    <textarea
      class="obs-area-input bg-azul form-control"
      [value]="prontuario.observacoes"
      readonly
    ></textarea>
  </div>

  <hdk-button
    text="Voltar para a lista"
    color="hdk-bg-verde"
    class="d-flex m-4 button"
    (click)="voltar()"
  >
  </hdk-button>
</div>

<div *ngIf="!prontuario" class="loading-container">
  <p>Carregando dados do prontuário...</p>
</div>
